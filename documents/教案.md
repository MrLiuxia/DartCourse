# 草稿

- 来源
- 为什么使用Dart
  - 两种编译模式 JIT AOT
- VS JAVA
  - 方法重载
- 坑
  - `==` 比较内存地址？
  - `.foreach`
- debug
- static
- 范型
- assert

![image-20191027112058764](/Users/liuxia/Library/Application Support/typora-user-images/image-20191027112058764.png)

![image-20191027171825542](/Users/liuxia/Library/Application Support/typora-user-images/image-20191027171825542.png)

```shell
# Dart
PATH="${PATH}:/Users/liuxia/Library/Android/dart-sdk/bin"
```



![image-20191027172039506](/Users/liuxia/Library/Application Support/typora-user-images/image-20191027172039506.png)



### Effective Dart

- 字符串
  - 推荐使用插值的形式来组合字符串和值，避免在字符串插值中使用多余的大括号

# 大纲

## 一. 前言

### 1. 课程介绍

- 面向有一定编程经验、希望快速上手Dart的同学，如会使用Java、Objective-C、JavaScript等语言之一
- 快速完成对Dart语言的入门，达到写Flutter应用程序的要求
- 如果想深入学习Dart，可查阅Dart官网或其他进阶书籍

### 2. Dart语言介绍

- 由Google开发的编程语言，初次公布与2011年，定位为web编程语言，以代替JavaScript并潜入Chrome为目标
- 当前被用于移动应用、web、服务器和物联网等领域的开发
- 纯面向对象、单继承
- 发布后数年内不温不火（对比2000年后诞生的语言，比如Google的Go， Apple的Swift）
- 近几年的发展不错，Google内部大型web项目使用Dart重构，Google新推出的跨平台移动端开发框架Flutter使用Dart构建，Google新操作系统Fuchsia（[ˈfjuːʃə]）也在使用Dart和Flutter

 ![img](https://gss2.bdstatic.com/-fo3dSag_xI4khGkpoWK1HF6hhy/baike/w%3D268%3Bg%3D0/sign=4cabf47761224f4a5799741531ccf76f/c83d70cf3bc79f3d068c6661b6a1cd11728b2976.jpg)

![Dart](https://dart.dev/assets/shared/dart/logo+text/horizontal/white-e71fb382ad5229792cc704b3ee7a88f8013e986d6e34f0956d89c453b454d0a5.svg)

### 3. 开发环境搭建

> https://dart.dev/get-dart

- Dart SDK
  - Windows

    1. 安装Chocolatey https://chocolatey.org/install
    
    2. 安装SDK
       - 安装稳定版(stable release)
![image-20191027105844380](/Users/liuxia/Workspace/IdeaProjects/DartLearning/documents/images/image-20191027105844380.png)
    
       ```
    C:\> choco install dart-sdk
       ```
       
       
       
       - 安装开发版(dev release)
       ![image-20191027110044225](/Users/liuxia/Workspace/IdeaProjects/DartLearning/documents/images/image-20191027110044225.png)
     - 手动安装
    
       http://www.gekorm.com/dart-windows/
    
       ![image-20191027110619923](/Users/liuxia/Workspace/IdeaProjects/DartLearning/documents/images/image-20191027110619923.png)
    
  - Linux
  
     Debian/Ubuntu 可使用 apt-get 安装，其他需手动安装
  
    ```shell
    # 安装
    $ sudo apt-get update
    $ sudo apt-get install apt-transport-https
    $ sudo sh -c 'curl https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -'
    $ sudo sh -c 'curl https://storage.googleapis.com/download.dartlang.org/linux/debian/dart_stable.list > /etc/apt/sources.list.d/dart_stable.list'
    $ sudo apt-get update
    $ sudo apt-get install dart
    
    # 如果需要dev版，则使用以下指令替换上面的第四步
    $ sudo sh -c 'curl https://storage.googleapis.com/download.dartlang.org/linux/debian/dart_unstable.list > /etc/apt/sources.list.d/dart_unstable.list'
    
    # 设置环境变量
    $ export PATH=/usr/lib/dart/bin:$PATH
    ```
  
  - Mac
  
    使用homebrew安装
  
    ```shell
    # 安装
    $ brew tap dart-lang/dart
    $ brew install dart            // 安装稳定版
    $ brew install dart --devel    // 安装dev版
    
    # 更新
    $ brew update
    $ brew upgrade dart
    $ brew cleanup dart
    
    # 查看安装路径等信息
    $ brew info dart
    ```
  
  - 确认SDK安装成功
  
    命令行中输入
  
    ```shell
    $ dart --version
    ```
  
    如果输出如下的信息，说明SDK安装成功
  
    ```
    Dart VM version: 1.24.2 (Thu Jun 22 08:42:17 2017) on "macos_x64"
    ```
  
  - 手动安装
  
    下载模板
  
    ```shell
    https://storage.googleapis.com/dart-archive/channels/${stable/dev}/release/${release-id}/sdk/dartsdk-${platform}-${architecture}-release.zip
    ```
  
    - stable/dev:：稳定/开发版 stable / dev
    - release-id：版本号
    - platform：平台，macos / linux / windows
    - architecture：系统架构，x64 / ia32
  
    如
  
    https://storage.googleapis.com/dart-archive/channels/stable/release/2.5.2/sdk/dartsdk-macos-x64-release.zip
  
- 编译器

  - Jetbrains家族 IntelliJ IDEA、WebStorm等
    - Dart插件 https://plugins.jetbrains.com/plugin/6351-dart
  - VS Code 
    - Dart Code插件 https://marketplace.visualstudio.com/items?itemName=Dart-Code.dart-code
  - Vim
    - dart-vim-plugin插件 https://github.com/dart-lang/dart-vim-plugin
  - 在线编译器
    - https://dart.dev/#try-dart

### 4. Hello world

### 5. 为什么Flutter使用Dart语言？

- Dart支持AOT(Ahead Of Time)编译，编译成快速、可预测的本地代码，使Flutter几乎都可以用Dart编写。这不仅使Flutter变得更快，而且几乎所有的东西（包括所有的小部件）都可以定制
- Dart也支持JIT(Just In Time) 编译，开发周期异常快，工作流颠覆常规（包括Flutter流行的亚秒级有状态热重载）
- Dart可以再没有锁的情况下进行对象分配和垃圾回收，避免了抢占式调度和共享内存，可以轻松创建以60fps运行的流畅动画
- Dart的声明式编程布局易于阅读和可视化，使Flutter不再需要单独的声明式布局语言，如JSX、XML
- 易于学习，具有静态语言和动态语言用户都熟悉的特性

> 使可视化编译器变得多余

> 与Instant run 的对比
>
> **Instant run**
>
> 构建修改的部分 -> 部署修改的dex或资源 -> 热部署、温部署、冷部署
>
> - 热拔插：代码改变被应用、投射到APP上，不需要重启应用，不需要重建当前activity。
>   场景：适用于多数的简单改变（包括一些方法实现的修改，或者变量值修改）
> - 温拔插：activity需要被重启才能看到所需更改。
>   场景：典型的情况是代码修改涉及到了资源文件，即resources。
> - 冷拔插：app需要被重启（但是仍然不需要重新安装）
>   场景：任何涉及结构性变化的，比如：修改了继承规则、修改了方法签名等。



## 二. 基本语法

### 0. 说在前面

- 所有能够使用变量引用的都是对象， 每个对象都是一个类的实例。在Dart中，数字、方法和null都是对象。所有的对象都继承于 [Object](https://api.dartlang.org/stable/dart-core/Object-class.html) 类。
- 使用静态类型(例如前面示例中的 `num` ) 可以更清晰的表明你的意图，并且可以让静态分析工具来分析你的代码， 但这并不是牵制性的。（在调试代码的时候你可能注意到 没有指定类型的变量的类型为 `dynamic`。）
- Dart 在运行之前会先解析你的代码。你可以通过使用类型或者编译时常量来帮助Dart去捕获异常以及让代码运行的更高效。
- Dart 支持顶级方法 (例如 `main()`)，同时还支持在类中定义函数。 （静态函数和实例函数）。 你还可以在方法中定义方法（嵌套方法或者局部方法）。
- 同样，Dart还支持顶级变量，以及在类中定义变量（静态变量和实例变量）。 实例变量有时候被称之为域（Fields）或者属性（Properties）。
- 和 Java 不同的是，Dart 没有 `public`、 `protected`、 和 `private` 关键字。如果一个标识符以 (_) 开头，则该标识符 在库内是私有的。详情请参考： [库和可见性](http://dart.goodev.org/guides/language/language-tour#libraries-and-visibility)。
- *标识符*可以以字母或者 _ 下划线开头，后面可以是 其他字符和数字的组合。
- 有时候 *表达式 expression* 和 *语句 statement* 是有区别的，所以这种情况我们会分别指明每种情况。
- Dart 工具可以指出两种问题：警告和错误。 警告只是说你的代码可能有问题， 但是并不会阻止你的代码执行。 错误可以是编译时错误也可以是运行时错误。遇到编译时错误时，代码将 无法执行；运行时错误将会在运行代码的时候导致一个 [异常](http://dart.goodev.org/guides/language/language-tour#exceptions)。

### 1. 关键字

| abstract 1 | continue   | false        | new        | this      |
| ---------- | ---------- | ------------ | ---------- | --------- |
| as 1       | default    | final        | null       | throw     |
| assert     | deferred 1 | finally      | operator 1 | true      |
| async 2    | do         | for          | part 1     | try       |
| async* 2   | dynamic 1  | get 1        | rethrow    | typedef 1 |
| await 2    | else       | if           | return     | var       |
| break      | enum       | implements 1 | set 1      | void      |
| case       | export 1   | import 1     | static 1   | while     |
| catch      | external 1 | in           | super      | with      |
| class      | extends    | is           | switch     | yield 2   |
| const      | factory 1  | library 1    | sync* 2    | yield* 2  |

- 上标1: 上下文相关的关键字，只有在特定的位置有特定的含义，在任何地方都是可以当作合法的标识符
- 上标2: 内置关键字，为了使Javascript代码更容易移植到dart，这些关键字在绝大多书地方都是可以使用的，但是不能当作类或成员变量的名字，也不能当作导入的前缀
- 上标3: 在Dart1.0发布后新增的用于支持异步相关特性的关键字，不能在标记为async、async\*或sync\*的方法体内使用async、await或yield作为标识符
- 其他：保留关键字，保留关键字也不能当作合法的标识符

### 2. 变量

#### 2.1 声明方式

本套课程中，给出的代码示例会使用assert断言来表示结果，assert后的表达式结果都会是true

多说一句，在实际开发中，使用assert是一个好习惯，在关键地方使用assert来校验数据，能够避免一些不必要的问题，开发过程中使用debug方式打包，会保留assert的代码，发布版本使用release打包方式，会自动去掉assert的代码

变量用于存储数据，Dart中万物皆对象，即变量存储的都是对对象的引用，或者说他们都指向某个对象

有两种基本的变量声明方式，一是使用var关键字，不指定类型，二是显示指定变量类型

因为有类型推导，以上两种声明方式的效果实际是一样的，都是创建一个名字为company的对象，存储一个内容为netease的字符串。官方推荐在函数内的本地变量尽量使用`var`声明。

在变量类型并不明确的场景下，可以使用`dynamic`关键字

注意：`dynamic`变量不会进行类型检查，它的类型安全完全由开发者自己负责!

#### 2.2 默认值

dart这方面和其他语言有明显的区别，无论什么类型的变量，在没有赋初始值的情况下，默认值为`null`

`null`也是对象，所以也可以理解为：未初始化的 Dart 变量都指向`null`对象。





NOTE

https://dart.dev

http://dart.goodev.org/guides/language/language-tour

https://jarontai.github.io/dart-souls/

https://dart.dev/get-dart

